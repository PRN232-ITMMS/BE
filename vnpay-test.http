### VNPay Payment Integration Test

### 1. Login first to get JWT token
POST https://localhost:7077/api/auth/login
Content-Type: application/json

{
  "email": "customer@example.com",
  "password": "Password123!"
}

### 2. Create VNPay Payment (Replace {{token}} with actual JWT token from login)
POST https://localhost:7077/api/payments/create
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "customerId": 8,
  "amount": 10000,
  "description": "Payment for fertility treatment consultation",
  "treatmentCycleId": 1,
  "appointmentId": null,
  "returnUrl": "https://localhost:3000/payment/success",
  "cancelUrl": "https://localhost:3000/payment/cancel"
}

### 2.1. Create VNPay Payment - Large Amount (IVF Treatment)
POST https://localhost:7077/api/payments/create
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "customerId": 8,
  "amount": 15000000,
  "description": "Payment for IVF Treatment Package - Premium",
  "treatmentCycleId": 2,
  "appointmentId": null,
  "returnUrl": "https://localhost:3000/payment/success",
  "cancelUrl": "https://localhost:3000/payment/cancel"
}

### 2.2. Create VNPay Payment - Appointment Payment
POST https://localhost:7077/api/payments/create
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "customerId": 8,
  "amount": 500000,
  "description": "Payment for doctor consultation appointment",
  "treatmentCycleId": null,
  "appointmentId": 1,
  "returnUrl": "https://localhost:3000/payment/success",
  "cancelUrl": "https://localhost:3000/payment/cancel"
}

### 3. Test VNPay Callback (Simulate VNPay response)
POST https://localhost:7077/api/payments/vnpay/callback
Content-Type: application/x-www-form-urlencoded

vnp_Amount=50000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14234567&vnp_CardType=ATM&vnp_OrderInfo=Payment+for+IVF+Treatment+Package&vnp_PayDate=20250107120000&vnp_ResponseCode=00&vnp_TmnCode=H9HN7C0Y&vnp_TransactionNo=14234567&vnp_TransactionStatus=00&vnp_TxnRef=payment-id-here&vnp_SecureHashType=SHA512&vnp_SecureHash=generated-hash-here

### 4. Get Payment History
GET https://localhost:7077/api/payments/history/8?page=1&pageSize=10
Authorization: Bearer {{token}}

### 5. Get Payment Status by Payment ID
GET https://localhost:7077/api/payments/status/{{paymentId}}
Authorization: Bearer {{token}}

### 6. Process Refund (Admin only)
POST https://localhost:7077/api/payments/refund
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "paymentId": "{{paymentId}}",
  "refundAmount": 250000,
  "reason": "Customer requested refund",
  "adminUserId": "admin-user-id"
}

### 7. VNPay Return URL validation (for frontend)
GET https://localhost:7077/api/payments/vnpay/return?vnp_Amount=50000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14234567&vnp_CardType=ATM&vnp_OrderInfo=Payment+for+IVF+Treatment+Package&vnp_PayDate=20250107120000&vnp_ResponseCode=00&vnp_TmnCode=H9HN7C0Y&vnp_TransactionNo=14234567&vnp_TransactionStatus=00&vnp_TxnRef=payment-id-here&vnp_SecureHashType=SHA512&vnp_SecureHash=generated-hash-here

### 8. Health Check
GET https://localhost:7077/health
